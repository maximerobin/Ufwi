#!/bin/sh
# File generated by EdenWall: {{ _generation_time_ }}
#
# SCRIPT NAME: resource.d/ifswitch
# DESCRIPTION:
#
#   Switch up or down all interfaces, except the dedicated one.  If, for
#   instance, the current interface list is: [eth0, eth1, eth2], and if the
#   dedicated interface is eth2, then the current script should be able to
#   switch the state of eth0 and of eth1.
#
switch_up() {
    for interface in {% for interface_name in UNDEDICATED_INTERFACE_NAMES %} '{{interface_name}}' {% endfor %}; do
        /sbin/ifup "$interface"
    done
}

switch_down() {
    for interface in {% for interface_name in UNDEDICATED_INTERFACE_NAMES %} '{{interface_name}}' {% endfor %}; do
        /sbin/ifdown "$interface"
    done
}

usage() {
    echo "usage: $0 (start|stop)"
    exit 1
}

if [ -z $1 ]; then
    usage
else
    if [[ "$1" == "start" ]]; then
        switch_up
    else
        sleep 3
        switch_down
    fi
fi

exit

