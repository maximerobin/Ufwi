# File generated by nuconf: {{ _generation_time_ }}
# /etc/ipsec.conf - Openswan IPsec configuration

version 2.0 # conforms to second version of ipsec.conf specification
config setup
        # NAT-TRAVERSAL support, see README.NAT-Traversal
        nat_traversal=yes
        # Debug-logging controls:  "none" for (almost) none, "all" for lots.
        # klipsdebug=none
        # plutodebug="control parsing"
        protostack=netkey


# Disabling Opportunistic Encryption
conn block
    auto=ignore

conn private
    auto=ignore

conn private-or-clear
    auto=ignore

conn clear-or-private
    auto=ignore

conn clear
    auto=ignore

conn packetdefault
    auto=ignore

{% if vpns -%}
    {%- for vpn in vpns -%}
        {%- if vpn.enabled -%}
# connection
conn {{ vpn.identifier }}
    left={{ vpn.public_address }}
    leftsubnet={{ vpn.local_network }}
    right={{ vpn.gateway }}
    rightsubnet={{ vpn.remote_network }}
    {% if vpn.rsa <= 0 -%}
    authby=secret
    {%- else -%}
    authby=rsasig
    leftrsasigkey={{ myfingerprint }}
    rightrsasigkey={{ vpn.fingerprint }}
    {%- endif %}
    auto=start
    {% if vpn.pfs -%}
    pfs=yes
    {%- else -%}
    pfs=no
    {%- endif %}
    ikelifetime={{vpn.ike_lifetime}}s
    keylife={{vpn.key_life}}s
    {% if vpn.esp -%}
    esp={{ vpn.esp }}
    {%- endif %}
#end connection

{% else %}
# connection {{ vpn.identifier }} is disabled
        {%- endif %}
    {%- endfor %}
{%- endif %}

